# Web后台管理系统 - 前端开发文档 (B2组)

## 1. 项目简介
本项目是“朋友圈（FriendZone）”Web 后台管理系统的核心业务模块——**内容管理**部分。
B2 组主要负责对平台内的帖子（纯文本、图文、视频）进行监控和管理、获取后端的统计数据并显示和绘制图表。
项目基于 B1 组搭建的框架基础，进一步实现了**与后端真实接口的对接**，完成了数据的动态渲染与多媒体资源的在线预览功能。

## 2. 技术栈
- **核心框架**: Vue 3 (Composition API / `<script setup>`)
- **构建工具**: Vite
- **UI 组件库**: Element Plus (使用了 Table, Image, Tag, Popconfirm 等组件)
- **网络请求**: Axios (封装了全局拦截器)
- **多媒体处理**: HTML5 Video / Element Plus Preview

## 3. 功能实现 (B2 职责)

### 3.1 内容管理模块
- **页面路径**: `/views` (对应视图 `ContentList.vue`)
- **核心功能**:
    - **多类型展示**: 能够解析后端返回的 `TEXT`、`IMAGE`、`VIDEO` 类型数据，并用不同颜色的 Tag 标签区分。
    - **媒体资源预览 (亮点)**:
        - **图片**: 实现了缩略图展示，点击可调出大图预览画廊（支持多图轮播）。
        - **视频**: 内嵌播放器，管理员可直接在列表页审核视频内容。
    - **违规处理**: 提供“删除”功能，配合气泡确认框（Popconfirm）保障操作安全。

### 3.2 仪表盘模块
- **页面路径**: `/views` (对应视图 `Dashboard.vue`)
- **核心功能**:
    - **多类型展示**: 能够解析后端返回的统计数据，显示不同统计的结果。
    - **图表展示**: 将返回的统计结果画成一个柱状图

### 3.3 前后端交互与数据处理
- **真实接口对接**: 已成功打通后端服务。
    - **GET** `/admin/post/list`: 获取分页帖子列表。
    - **POST** `/admin/post/delete/{id}`: 强制删除违规帖子。
- **跨域与资源访问**:
    - 解决了本地开发环境 (`localhost`) 访问远程后端服务器资源时的路径问题。
    - 封装了 `getMediaUrl` 工具函数，自动拼接后端 IP 地址，确保图片/视频正常加载。

## 4. 项目结构说明 (B2 新增/修改)
```text
admin-web/
├── src/
│   ├── utils/
│   │   └── request.js      # (新增) Axios 封装，处理 BaseURL 和 响应拦截
│   ├── views/          
│   │   └── ContentList.vue    # (新增) 内容管理核心组件，包含表格与媒体预览逻辑
│   │   └── Dashboard.vue    # (新增) 仪表盘核心组件，包含统计数据和图表
│   └── ...
```

## 5. 关键代码逻辑

### 5.1 远程资源路径处理
由于后端图片存储在服务器磁盘，前端需动态拼接访问地址：
```javascript
// ContentList.vue
// 配置后端服务器真实 IP，解决 ERR_CONNECTION_REFUSED 问题
const BASE_URL = 'http://192.168.X.X:8080' 

const getMediaUrl = (path) => {
  if (!path) return ''
  if (path.startsWith('http')) return path
  return `${BASE_URL}${path}`
}
```

### 5.2 数据结构适配
针对后端返回的多层级 JSON 数据（`data.data.records`），在前端做了兼容性处理，防止页面白屏：
```javascript
const fetchData = async () => {
  const res = await request.get('/admin/post/list')
  // 兼容不同的后端返回结构
  if (res.data && res.data.records) {
    tableData.value = res.data.records
  } else {
    tableData.value = res.records || []
  }
}
```

## 6. 运行指南

### 6.1 配置后端地址
打开 `src/views/ContentList.vue`，找到 `BASE_URL` 常量：
```javascript
const BASE_URL = 'http://[后端电脑的IP]:8080'
```
*注意：请确保前端开发机能 ping 通后端服务器 IP。*

### 6.2 启动服务
```bash
npm run dev
```
访问 `http://localhost:5173`，点击侧边栏“内容管理”即可看到实时数据。

## 7. 遇到的问题与解决方案
1.  **问题**：图片无法显示，控制台报错连接被拒绝。
    *   **原因**：前端请求了 localhost 的 8080 端口，但后端服务不在本机。
    *   **解决**：将请求基准地址修改为后端同学提供的真实局域网 IP。
2.  **问题**：表格显示 "No Data" 但接口请求成功。
    *   **原因**：后端返回的数据包裹层级较深，前端取值路径错误。
    *   **解决**：通过 DevTools 观察响应结构，调整代码为 `res.data.records`。

---